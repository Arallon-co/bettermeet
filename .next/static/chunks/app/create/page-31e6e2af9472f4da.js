(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[323],{7402:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>D});var a=t(5155),l=t(2115),r=t(5695),n=t(7290),i=t(4736),o=t(5054),c=t(3176),d=t(9270),m=t(4554),x=t(6146),h=t(6477),u=t(714),g=t(7031),p=t(2227),f=t(4500);function j(e){let{selectedDates:s,onChange:t,organizerTimezone:r,error:o,className:c=""}=e,d=(0,l.useMemo)(()=>{let e=new Date;return[{label:"Tomorrow",description:"Next 1 day",dates:[(0,h.GP)((0,u.f)(e,1),"yyyy-MM-dd")],icon:"\uD83D\uDCC5"},{label:"Next 3 Days",description:"Starting tomorrow",dates:[(0,h.GP)((0,u.f)(e,1),"yyyy-MM-dd"),(0,h.GP)((0,u.f)(e,2),"yyyy-MM-dd"),(0,h.GP)((0,u.f)(e,3),"yyyy-MM-dd")],icon:"\uD83D\uDCC6"},{label:"Next 7 Days",description:"Starting tomorrow",dates:Array.from({length:7},(s,t)=>(0,h.GP)((0,u.f)(e,t+1),"yyyy-MM-dd")),icon:"\uD83D\uDDD3️"}]},[]),j=0===s.length?null:d.find(e=>e.dates.length===s.length&&e.dates.every(e=>s.includes(e)));return(0,a.jsxs)("div",{className:"space-y-6 ".concat(c),children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(p.A,{className:"w-6 h-6 text-primary-600"}),(0,a.jsx)("h4",{className:"text-lg font-semibold text-foreground",children:"Select Date Range"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:d.map((e,s)=>{let l=(null==j?void 0:j.label)===e.label;return(0,a.jsx)(n.Z,{className:"cursor-pointer transition-all duration-200 hover:scale-105 ".concat(l?"ring-2 ring-primary-500 bg-primary-50 border-primary-200":"hover:bg-foreground-50"),isPressable:!0,onPress:()=>{t(e.dates)},children:(0,a.jsxs)(i.U,{className:"p-6 text-center",children:[(0,a.jsx)("div",{className:"text-3xl mb-3",children:e.icon}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 ".concat(l?"text-primary-700":"text-foreground"),children:e.label}),(0,a.jsx)("p",{className:"text-sm ".concat(l?"text-primary-600":"text-foreground-600"),children:e.description}),(0,a.jsxs)("div",{className:"mt-3 text-xs text-foreground-500",children:[e.dates.length," day",1!==e.dates.length?"s":""]})]})},s)})}),s.length>0&&(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(x.T,{variant:"light",color:"danger",onPress:()=>{t([])},className:"min-h-[40px]",startContent:(0,a.jsx)(f.A,{className:"w-4 h-4"}),children:"Clear Selection"})})]}),s.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("h4",{className:"text-lg font-semibold text-foreground",children:["Selected Dates (",s.length,")"]})}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map(e=>(0,a.jsx)(m.R,{variant:"flat",color:"primary",className:"text-sm font-medium px-3 py-1",startContent:(0,a.jsx)(p.A,{className:"w-4 h-4"}),children:(e=>{try{return(0,g.qD)(new Date(e),r,"MMM dd")}catch(s){return(0,h.GP)(new Date(e),"MMM dd")}})(e)},e))}),(0,a.jsx)("div",{className:"p-4 bg-primary-50 border border-primary-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-primary-700",children:[(0,a.jsx)("strong",{children:"Time slots:"})," 9:00 AM - 5:00 PM in your timezone (",r,")"]})})]}),o&&(0,a.jsx)("div",{className:"p-4 bg-danger-50 border border-danger-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-danger text-sm font-medium",children:o})})]})}var N=t(8794);let y=["09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00"];function b(e){let{selectedDates:s,timeSlots:t,onChange:r,organizerTimezone:n,error:i,className:o=""}=e,[c,d]=(0,l.useState)(!1),[m,u]=(0,l.useState)(null),[p,j]=(0,l.useState)(null),[b,v]=(0,l.useState)(null),w=(0,l.useRef)(null);l.useEffect(()=>{s.length>0&&0===t.length&&r(function(e,s){let t=["09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00"],a=[];return e.forEach(e=>{t.forEach(s=>{let t=new Date((0,N.H)("".concat(e,"T").concat(s,":00")).getTime()+18e5),l=(0,h.GP)(t,"HH:mm");a.push({date:e,startTime:s,endTime:l})})}),a}(s,0))},[s,t.length,n,r]);let M=(0,l.useCallback)(e=>{try{return(0,g.qD)((0,N.H)(e),n,"MMM dd")}catch(s){return(0,h.GP)((0,N.H)(e),"MMM dd")}},[n]),T=(0,l.useCallback)(e=>{try{let s=new Date("2000-01-01T".concat(e));return(0,g.qD)(s,n,"h:mm a")}catch(s){return(0,h.GP)(new Date("2000-01-01T".concat(e)),"h:mm a")}},[n]),P=(0,l.useCallback)((e,s)=>t.some(t=>t.date===e&&t.startTime===s),[t]),S=(0,l.useCallback)(e=>y.indexOf(e),[]),C=(0,l.useCallback)(e=>s.indexOf(e),[s]),z=(0,l.useCallback)((e,s)=>{if(!m||!p)return!1;let t=C(m.date),a=C(p.date),l=S(m.timeSlot),r=S(p.timeSlot),n=C(e),i=S(s),o=Math.min(t,a),c=Math.max(t,a),d=Math.min(l,r),x=Math.max(l,r);return n>=o&&n<=c&&i>=d&&i<=x},[m,p,C,S]),D=(0,l.useCallback)((e,s)=>{let a=P(e,s);if(d(!0),u({date:e,timeSlot:s}),j({date:e,timeSlot:s}),v(a?"deselect":"select"),a)r(t.filter(t=>t.date!==e||t.startTime!==s));else{let a=(0,h.GP)(new Date("2000-01-01T".concat(s)).getTime()+18e5,"HH:mm");r([...t,{date:e,startTime:s,endTime:a}])}},[P,t,r]),A=(0,l.useCallback)((e,s)=>{c&&m&&b&&j({date:e,timeSlot:s})},[c,m,b]),k=(0,l.useCallback)(()=>{if(c&&m&&p&&b){let e=C(m.date),a=C(p.date),l=S(m.timeSlot),n=S(p.timeSlot),i=Math.min(e,a),o=Math.max(e,a),c=Math.min(l,n),d=Math.max(l,n);if("deselect"===b)r(t.filter(e=>{let s=C(e.date),t=S(e.startTime);return!(s>=i&&s<=o&&t>=c&&t<=d)}));else{let e=[...t];for(let t=i;t<=o;t++)for(let a=c;a<=d;a++){let l=s[t],r=y[a];if(l&&r){let s=(0,h.GP)(new Date("2000-01-01T".concat(r)).getTime()+18e5,"HH:mm");e.some(e=>e.date===l&&e.startTime===r)||e.push({date:l,startTime:r,endTime:s})}}r(e)}}d(!1),u(null),j(null),v(null)},[c,m,p,b,C,S,t,r,s]),E=(0,l.useCallback)(()=>{r([])},[r]);return 0===s.length?(0,a.jsx)("div",{className:"space-y-4 ".concat(o),children:(0,a.jsx)("div",{className:"text-center p-8 bg-foreground-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-foreground-500",children:"Please select dates first to configure time slots"})})}):(0,a.jsxs)("div",{className:"space-y-8 ".concat(o),children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h4",{className:"text-lg font-semibold text-foreground",children:["Business Hours Time Slots (",s.length," days)"]}),(0,a.jsx)(x.T,{variant:"light",color:"danger",onPress:E,className:"min-h-[40px]",startContent:(0,a.jsx)(f.A,{className:"w-4 h-4"}),children:"Clear All"})]}),(0,a.jsx)("div",{ref:w,className:"overflow-x-auto",onMouseUp:k,onMouseLeave:k,children:(0,a.jsxs)("div",{className:"min-w-max",children:[(0,a.jsxs)("div",{className:"grid gap-1 mb-2",style:{gridTemplateColumns:"120px repeat(".concat(s.length,", 1fr)")},children:[(0,a.jsx)("div",{className:"h-8"})," ",s.map(e=>(0,a.jsx)("div",{className:"h-8 flex items-center justify-center text-sm font-medium text-foreground bg-foreground-50 rounded-lg",children:M(e)},e))]}),(0,a.jsx)("div",{className:"grid gap-1",style:{gridTemplateColumns:"120px repeat(".concat(s.length,", 1fr)")},children:y.map(e=>(0,a.jsxs)(l.Fragment,{children:[(0,a.jsx)("div",{className:"h-8 flex items-center justify-end pr-3 text-sm text-foreground-600 font-medium",children:T(e)}),s.map(s=>{let t=P(s,e),l=z(s,e);return(0,a.jsx)("button",{onMouseDown:()=>D(s,e),onMouseEnter:()=>A(s,e),className:"\n                                                    h-8 border border-divider rounded transition-all duration-150\n                                                    ".concat(t||l?"bg-primary-500 border-primary-600":"bg-foreground-50 hover:bg-foreground-100","\n                                                    ").concat(c?"cursor-crosshair":"cursor-pointer","\n                                                ")},"".concat(s,"-").concat(e))})]},e))})]})}),(0,a.jsx)("p",{className:"text-sm text-foreground-500 text-center",children:"Click and drag to select/deselect time slots during business hours (9 AM - 5 PM)"})]}),i&&(0,a.jsx)("div",{className:"p-4 bg-danger-50 border border-danger-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-danger text-sm font-medium",children:i})})]})}var v=t(586),w=t(4702),M=t(4219),T=t(2771),P=t(5529);let S=[{id:1,title:"Basic Info",icon:M.A},{id:2,title:"Date Range",icon:p.A},{id:3,title:"Review",icon:T.A}];function C(e){let{onSubmit:s,isLoading:t=!1}=e,[r,h]=(0,l.useState)(1),[u,g]=(0,l.useState)({title:"",description:"",dates:[],timeSlots:[],organizerTimezone:""}),f=(0,w.dj)(),N=e=>{g(s=>({...s,...e}))},y=r/S.length*100;return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,a.jsx)(n.Z,{className:"w-full",children:(0,a.jsx)(i.U,{className:"p-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Create Poll"}),(0,a.jsxs)("span",{className:"text-sm text-foreground-600",children:["Step ",r," of ",S.length]})]}),(0,a.jsx)(o.o,{value:y,color:"primary",className:"w-full",size:"sm"}),(0,a.jsx)("div",{className:"flex justify-between",children:S.map(e=>(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-2 ".concat(e.id<=r?"text-primary-600":"text-foreground-400"),children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat(e.id<=r?"bg-primary-100":"bg-foreground-100"),children:(0,a.jsx)(e.icon,{className:"w-4 h-4"})}),(0,a.jsx)("span",{className:"text-xs font-medium",children:e.title})]},e.id))})]})})}),(0,a.jsx)(n.Z,{className:"w-full",children:(0,a.jsxs)(i.U,{className:"p-6",children:[1===r&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Basic Information"}),(0,a.jsx)("p",{className:"text-sm text-foreground-600 mb-6",children:"Start by providing the basic details for your scheduling poll."})]}),(0,a.jsx)(c.r,{label:"Poll Title",placeholder:"Enter poll title",value:u.title,onValueChange:e=>N({title:e}),isRequired:!0,className:"w-full",startContent:(0,a.jsx)(M.A,{className:"w-4 h-4 text-foreground-400"})}),(0,a.jsx)(d.P,{label:"Description (Optional)",placeholder:"Add a description for your poll",value:u.description,onValueChange:e=>N({description:e}),className:"w-full",minRows:3,maxRows:6}),(0,a.jsx)(v.N,{value:u.organizerTimezone,onChange:e=>N({organizerTimezone:e}),label:"Your Timezone",showCurrentTime:!0,isRequired:!0})]}),2===r&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Date Range & Business Hours"}),(0,a.jsx)("p",{className:"text-sm text-foreground-600 mb-6",children:"Choose a date range. Time slots will be automatically set to business hours (9 AM - 5 PM)."})]}),(0,a.jsx)(j,{selectedDates:u.dates,onChange:e=>N({dates:e}),organizerTimezone:u.organizerTimezone}),u.dates.length>0&&(0,a.jsx)(b,{selectedDates:u.dates,timeSlots:u.timeSlots,onChange:e=>N({timeSlots:e}),organizerTimezone:u.organizerTimezone})]}),3===r&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Review & Create"}),(0,a.jsx)("p",{className:"text-sm text-foreground-600 mb-6",children:"Review your poll details before creating."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-foreground-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-foreground mb-2",children:u.title}),u.description&&(0,a.jsx)("p",{className:"text-sm text-foreground-600 mb-3",children:u.description}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 text-foreground-400"}),(0,a.jsxs)("span",{className:"text-sm",children:[u.dates.length," date",1!==u.dates.length?"s":""," selected"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(T.A,{className:"w-4 h-4 text-foreground-400"}),(0,a.jsxs)("span",{className:"text-sm",children:[u.timeSlots.length," time slot",1!==u.timeSlots.length?"s":""," configured"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(P.A,{className:"w-4 h-4 text-foreground-400"}),(0,a.jsxs)("span",{className:"text-sm",children:["Timezone: ",u.organizerTimezone]})]})]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:u.dates.map((e,s)=>(0,a.jsx)(m.R,{variant:"flat",color:"primary",size:"sm",children:new Date(e).toLocaleDateString()},s))})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center pt-6",children:[(0,a.jsx)(x.T,{variant:"bordered",onPress:()=>{r>1&&h(r-1)},isDisabled:1===r,className:"min-h-[44px]",children:"Previous"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"text-sm text-foreground-500",children:["Step ",r," of ",S.length]}),(0,a.jsx)(x.T,{color:"primary",onPress:r<S.length?()=>{r<S.length&&h(r+1)}:()=>u.title.trim()?0===u.dates.length?void f.showError("Please select at least one date"):0===u.timeSlots.length?void f.showError("Please add at least one time slot"):u.organizerTimezone?void s({title:u.title.trim(),description:u.description.trim(),dates:u.dates,timeSlots:u.timeSlots,organizerTimezone:u.organizerTimezone}):void f.showError("Please select your timezone"):void f.showError("Please enter a poll title"),isLoading:t&&r===S.length,className:"min-h-[44px] px-6 text-white",children:r<S.length?"Next →":"Create Poll"})]})]})]})})]})}var z=t(6236);function D(){let e=(0,r.useRouter)(),s=(0,w.dj)(),t=async t=>{try{let a=await fetch("/api/polls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error("Failed to create poll");let l=await a.json();s.showSuccess("Poll created successfully! Share the link with participants."),e.push("/poll/".concat(l.id))}catch(e){console.error("Error creating poll:",e),s.showError("Failed to create poll. Please try again.")}};return(0,a.jsx)(z.A,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold text-foreground",children:"Create a New Poll"}),(0,a.jsx)("p",{className:"text-foreground-600 max-w-2xl mx-auto",children:"Set up a scheduling poll with multiple time slots and timezone support"})]}),(0,a.jsx)(C,{onSubmit:t})]})})}},7857:(e,s,t)=>{Promise.resolve().then(t.bind(t,7402))}},e=>{e.O(0,[204,494,394,790,168,511,942,441,964,358],()=>e(e.s=7857)),_N_E=e.O()}]);